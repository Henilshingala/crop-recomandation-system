import pandas as pd
import numpy as np

ROWS_PER_CROP = 200
RANDOM_STATE = 42

crop_params = {
    # Cereals
    'rice': {'N': (80, 120), 'P': (40, 60), 'K': (40, 60), 'temp': (22, 28), 'hum': (80, 90), 'ph': (6.0, 7.0), 'rain': (200, 300)},
    'wheat': {'N': (80, 120), 'P': (40, 60), 'K': (30, 50), 'temp': (15, 25), 'hum': (50, 70), 'ph': (6.0, 7.0), 'rain': (45, 80)},
    'maize': {'N': (80, 120), 'P': (40, 60), 'K': (20, 40), 'temp': (20, 28), 'hum': (55, 70), 'ph': (5.5, 7.0), 'rain': (60, 110)},
    'barley': {'N': (60, 90), 'P': (20, 45), 'K': (20, 45), 'temp': (12, 23), 'hum': (40, 60), 'ph': (6.0, 7.5), 'rain': (35, 60)},
    'jowar': {'N': (80, 120), 'P': (40, 60), 'K': (40, 60), 'temp': (26, 34), 'hum': (40, 60), 'ph': (6.0, 7.5), 'rain': (50, 85)},
    'bajra': {'N': (40, 80), 'P': (30, 50), 'K': (30, 50), 'temp': (28, 36), 'hum': (30, 50), 'ph': (6.5, 8.0), 'rain': (30, 65)},
    'ragi': {'N': (50, 80), 'P': (20, 40), 'K': (20, 40), 'temp': (26, 35), 'hum': (40, 70), 'ph': (5.0, 7.5), 'rain': (60, 100)},

    # Pulses
    'chickpea': {'N': (20, 40), 'P': (55, 80), 'K': (75, 85), 'temp': (17, 22), 'hum': (15, 20), 'ph': (6.0, 7.5), 'rain': (65, 90)},
    'kidneybeans': {'N': (15, 35), 'P': (55, 80), 'K': (15, 25), 'temp': (18, 27), 'hum': (18, 25), 'ph': (5.5, 6.2), 'rain': (90, 150)},
    'pigeonpeas': {'N': (15, 35), 'P': (55, 80), 'K': (15, 25), 'temp': (26, 32), 'hum': (35, 65), 'ph': (5.0, 7.0), 'rain': (90, 160)},
    'mothbeans': {'N': (10, 35), 'P': (35, 60), 'K': (15, 25), 'temp': (25, 32), 'hum': (30, 60), 'ph': (5.0, 7.5), 'rain': (30, 70)},
    'mungbean': {'N': (10, 35), 'P': (35, 60), 'K': (15, 25), 'temp': (27, 32), 'hum': (60, 70), 'ph': (6.2, 7.2), 'rain': (35, 60)},
    'blackgram': {'N': (30, 40), 'P': (55, 80), 'K': (15, 25), 'temp': (25, 32), 'hum': (60, 70), 'ph': (6.5, 7.5), 'rain': (60, 80)},
    'lentil': {'N': (10, 35), 'P': (55, 80), 'K': (15, 25), 'temp': (18, 27), 'hum': (60, 70), 'ph': (6.0, 7.5), 'rain': (35, 55)},
    'soybean': {'N': (20, 50), 'P': (55, 80), 'K': (30, 60), 'temp': (20, 32), 'hum': (40, 70), 'ph': (6.0, 7.5), 'rain': (60, 100)},

    # Fruits
    'apple': {'N': (20, 40), 'P': (20, 40), 'K': (150, 200), 'temp': (15, 24), 'hum': (70, 90), 'ph': (5.5, 6.5), 'rain': (100, 130)},
    'banana': {'N': (100, 150), 'P': (60, 80), 'K': (150, 250), 'temp': (25, 30), 'hum': (80, 95), 'ph': (5.5, 7.0), 'rain': (150, 250)},
    'grapes': {'N': (20, 50), 'P': (30, 50), 'K': (150, 200), 'temp': (20, 35), 'hum': (50, 70), 'ph': (5.5, 7.0), 'rain': (40, 70)},
    'mango': {'N': (15, 40), 'P': (20, 40), 'K': (25, 35), 'temp': (27, 35), 'hum': (45, 60), 'ph': (4.5, 7.0), 'rain': (85, 110)},
    'orange': {'N': (40, 80), 'P': (20, 40), 'K': (20, 50), 'temp': (15, 30), 'hum': (60, 80), 'ph': (6.0, 7.5), 'rain': (80, 120)},
    'papaya': {'N': (50, 80), 'P': (40, 60), 'K': (50, 80), 'temp': (25, 35), 'hum': (75, 90), 'ph': (6.0, 7.0), 'rain': (150, 250)},
    'pomegranate': {'N': (30, 60), 'P': (20, 40), 'K': (30, 60), 'temp': (28, 40), 'hum': (30, 50), 'ph': (6.0, 7.5), 'rain': (35, 65)},
    'watermelon': {'N': (80, 100), 'P': (10, 30), 'K': (45, 55), 'temp': (25, 32), 'hum': (40, 55), 'ph': (6.0, 7.0), 'rain': (40, 60)},
    'muskmelon': {'N': (90, 110), 'P': (10, 30), 'K': (45, 55), 'temp': (27, 32), 'hum': (40, 55), 'ph': (6.0, 7.0), 'rain': (30, 50)},
    'coconut': {'N': (20, 40), 'P': (10, 30), 'K': (25, 35), 'temp': (25, 29), 'hum': (70, 90), 'ph': (5.0, 6.0), 'rain': (150, 220)},
    'guava': {'N': (20, 40), 'P': (20, 40), 'K': (20, 40), 'temp': (23, 30), 'hum': (50, 70), 'ph': (6.0, 7.5), 'rain': (80, 140)},
    'sapota': {'N': (30, 50), 'P': (20, 30), 'K': (30, 50), 'temp': (25, 35), 'hum': (70, 85), 'ph': (6.0, 8.0), 'rain': (130, 180)},
    'lemon': {'N': (40, 80), 'P': (20, 40), 'K': (20, 50), 'temp': (20, 30), 'hum': (50, 70), 'ph': (5.5, 7.0), 'rain': (65, 95)},
    'mosambi': {'N': (40, 80), 'P': (20, 40), 'K': (20, 50), 'temp': (22, 32), 'hum': (50, 75), 'ph': (6.0, 7.5), 'rain': (65, 95)},
    'custard_apple': {'N': (15, 35), 'P': (15, 35), 'K': (15, 35), 'temp': (25, 35), 'hum': (40, 65), 'ph': (6.5, 7.5), 'rain': (50, 85)},
    'date_palm': {'N': (20, 40), 'P': (10, 30), 'K': (20, 40), 'temp': (30, 42), 'hum': (20, 40), 'ph': (7.0, 8.5), 'rain': (15, 35)},
    'ber': {'N': (10, 30), 'P': (10, 30), 'K': (10, 30), 'temp': (25, 40), 'hum': (25, 50), 'ph': (7.0, 8.5), 'rain': (20, 50)},

    # Vegetables
    'tomato': {'N': (50, 70), 'P': (40, 60), 'K': (50, 70), 'temp': (20, 30), 'hum': (60, 80), 'ph': (6.0, 7.0), 'rain': (60, 100)},
    'potato': {'N': (60, 90), 'P': (40, 60), 'K': (50, 80), 'temp': (15, 25), 'hum': (50, 70), 'ph': (5.0, 6.0), 'rain': (50, 80)},
    'onion': {'N': (60, 90), 'P': (40, 60), 'K': (50, 80), 'temp': (15, 30), 'hum': (50, 70), 'ph': (6.0, 7.0), 'rain': (50, 80)},
    'brinjal': {'N': (80, 100), 'P': (60, 80), 'K': (40, 60), 'temp': (20, 30), 'hum': (60, 80), 'ph': (5.5, 6.8), 'rain': (80, 120)},
    'okra': {'N': (60, 80), 'P': (40, 60), 'K': (30, 50), 'temp': (25, 35), 'hum': (60, 80), 'ph': (6.0, 7.0), 'rain': (80, 120)},
    'cabbage': {'N': (80, 120), 'P': (60, 90), 'K': (80, 120), 'temp': (15, 22), 'hum': (60, 85), 'ph': (6.0, 7.5), 'rain': (60, 100)},
    'cauliflower': {'N': (80, 120), 'P': (60, 90), 'K': (80, 120), 'temp': (15, 25), 'hum': (60, 85), 'ph': (6.0, 7.5), 'rain': (60, 100)},
    'carrot': {'N': (50, 80), 'P': (40, 60), 'K': (80, 100), 'temp': (15, 22), 'hum': (50, 70), 'ph': (6.0, 7.0), 'rain': (40, 80)},
    'radish': {'N': (50, 80), 'P': (40, 60), 'K': (80, 100), 'temp': (12, 25), 'hum': (50, 70), 'ph': (6.0, 7.0), 'rain': (40, 80)},
    'spinach': {'N': (20, 50), 'P': (20, 40), 'K': (20, 40), 'temp': (12, 25), 'hum': (50, 70), 'ph': (6.0, 7.5), 'rain': (50, 80)},
    'bottle_gourd': {'N': (50, 70), 'P': (40, 60), 'K': (40, 60), 'temp': (25, 35), 'hum': (60, 80), 'ph': (6.0, 7.5), 'rain': (60, 100)},
    'bitter_gourd': {'N': (50, 70), 'P': (40, 60), 'K': (40, 60), 'temp': (25, 35), 'hum': (60, 80), 'ph': (6.0, 7.5), 'rain': (60, 100)},
    'ridge_gourd': {'N': (50, 70), 'P': (40, 60), 'K': (40, 60), 'temp': (25, 35), 'hum': (60, 80), 'ph': (6.0, 7.5), 'rain': (60, 100)},
    'cucumber': {'N': (60, 80), 'P': (40, 60), 'K': (50, 70), 'temp': (20, 30), 'hum': (70, 90), 'ph': (5.5, 7.0), 'rain': (80, 120)},
    'green_chilli': {'N': (60, 90), 'P': (40, 60), 'K': (50, 70), 'temp': (20, 30), 'hum': (60, 80), 'ph': (6.0, 7.0), 'rain': (60, 100)},

    # Commercial/Others
    'cotton': {'N': (110, 130), 'P': (40, 60), 'K': (50, 80), 'temp': (22, 28), 'hum': (60, 80), 'ph': (6.0, 8.0), 'rain': (60, 100)},
    'jute': {'N': (60, 90), 'P': (35, 55), 'K': (35, 45), 'temp': (23, 28), 'hum': (75, 90), 'ph': (6.0, 7.5), 'rain': (140, 200)},
    'coffee': {'N': (90, 110), 'P': (20, 40), 'K': (25, 35), 'temp': (23, 27), 'hum': (50, 70), 'ph': (6.0, 7.0), 'rain': (110, 190)},
    'sugarcane': {'N': (120, 150), 'P': (50, 70), 'K': (60, 120), 'temp': (24, 32), 'hum': (70, 85), 'ph': (6.0, 7.5), 'rain': (180, 240)},
    'tobacco': {'N': (40, 70), 'P': (35, 55), 'K': (80, 120), 'temp': (22, 30), 'hum': (55, 70), 'ph': (5.5, 7.0), 'rain': (40, 70)},
    'castor': {'N': (30, 50), 'P': (25, 40), 'K': (25, 40), 'temp': (22, 30), 'hum': (40, 60), 'ph': (5.5, 7.5), 'rain': (50, 70)},
    'sesame': {'N': (25, 45), 'P': (20, 35), 'K': (20, 35), 'temp': (25, 33), 'hum': (50, 70), 'ph': (5.5, 7.5), 'rain': (40, 70)},
    'groundnut': {'N': (20, 40), 'P': (40, 60), 'K': (30, 50), 'temp': (25, 32), 'hum': (45, 65), 'ph': (5.5, 7.0), 'rain': (50, 95)},
    'mustard': {'N': (60, 95), 'P': (40, 60), 'K': (20, 35), 'temp': (12, 24), 'hum': (40, 60), 'ph': (6.0, 7.5), 'rain': (40, 60)}
}
def linspace_clip(min_val, max_val, n, decimals):
    vals = np.linspace(min_val, max_val, n)
    vals = np.round(vals, decimals)
    return np.clip(vals, min_val, max_val)

data = []

for crop, p in crop_params.items():
    N = linspace_clip(*p['N'], ROWS_PER_CROP, 1)
    P = linspace_clip(*p['P'], ROWS_PER_CROP, 1)
    K = linspace_clip(*p['K'], ROWS_PER_CROP, 1)
    T = linspace_clip(*p['temp'], ROWS_PER_CROP, 2)
    H = linspace_clip(*p['hum'], ROWS_PER_CROP, 2)
    PH = linspace_clip(*p['ph'], ROWS_PER_CROP, 2)
    R = linspace_clip(*p['rain'], ROWS_PER_CROP, 1)

    for i in range(ROWS_PER_CROP):
        row = {
            'N': N[i],
            'P': P[(i + 37) % ROWS_PER_CROP],
            'K': K[(i + 73) % ROWS_PER_CROP],
            'temperature': T[(i + 11) % ROWS_PER_CROP],
            'humidity': H[(i + 59) % ROWS_PER_CROP],
            'ph': PH[(i + 101) % ROWS_PER_CROP],
            'rainfall': R[(i + 149) % ROWS_PER_CROP],
            'label': crop
        }
        data.append(row)

df = pd.DataFrame(data)

# Shuffle once to avoid ordering bias
df = df.sample(frac=1, random_state=RANDOM_STATE).reset_index(drop=True)

# Save clean CSV
df.to_csv("Crop_recommendation_synthetic_V1.csv", index=False)

print("CSV GENERATED SUCCESSFULLY")
print(f"Total crops: {len(crop_params)}")
print(f"Rows per crop: {ROWS_PER_CROP}")
print(f"Total rows: {len(df)}")
print("Columns:", list(df.columns))